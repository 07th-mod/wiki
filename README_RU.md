# 07th-Mod Wiki

Эта вики была создана что бы заменить старую вики на гитхабе. Для сборки и сопровождения проекта используется mkdocs.
Репозиторий содержит исходники необходимые для тестирования, изменения и компилирования вики.

Эта вики хостится на нашем сайте https://07th-mod.com/wiki/ . Сайт будет периодически обновляться
в соответствии с изменениями в этом репозитории (может потребоваться некоторое время для того, чтобы увидеть изменения - попытатесь обновить страницу в браузере)

**Примечание**: в этой папке собрано немного полезных скриптов для установки и запуска сервера. 

## Зависимости
* Python 2.7 or 3.4 или новее
* [mkdocs](https://www.mkdocs.org/)
* [mkdocs-material](https://github.com/squidfunk/mkdocs-material)
* [mkdocs-minify-plugin](https://github.com/byrnereese/mkdocs-minify-plugin)

## Как установить окружение для редактирования вики

### Быстрый путь для гну линуксоидов
```bash
bash -c "$(curl -s https://raw.githubusercontent.com/Lenin1917/wiki/master/dev_scripts/install.sh)"
```

Сперва клонируйте этот репозиторий что бы иметь все файлы для изменения вики. 

### 1. Установка Python

Вы должны установить Python и pip (пакетный менеджер для python) сами на свою систему.

* На Windows, устновите установщик Пайтона с оффициального сайта, который установит и `Python` и `pip`. 
* На GNU/Linux, используйте пакетный менеджер, установленный в вашей системе для pip и Python (это разные пакеты, но Python обычно идёт в поставке со многими дистрибутивами)
  * Ubuntu/Debian: `sudo apt install python3-pip`
* На Mac, запустите `sudo easy_install pip` что бы установить pip (подразумевается что на маке уже есть интерпритатор Python).

### 2. Установка mkdocs

> Прим. переводчика: рекомендую сначала поднять виртуальное окружение `python3 -m venv <имя окружения>` и активировать его `source <имя окружения>/bin/activate` и уже в нем вводить последующие команды

Вы должны установить mkdocs -- python инструмент для компилирования markdown файликов в вики. mkdocs идёт вместе со встроенным сервером, позволяющим видеть в живом времени изменения при редактировании markdown файликов. Это делает редактирование проще и снижает количество ошибок.

#### 2a. Автоматическая установка mkdocs


Внутри папки `dev_scripts` этого репозитория, запустите следующий скрипт для автоматической установки mkdocs. Вы уже должны иметь Python и pip.

* `dev_scripts\install_mkdocs_and_plugins.bat` на Windows
* `dev_scripts\install_mkdocs_and_plugins` на GNU/Linux

Если не помогло, следуйте инструкциям ниже для самостоятельной установки.

#### 2b. Установка mkdocs самостоятельно

Устанвите mkdocs c плагинами как показано ниже:

* Устанвите `mkdocs` с помощью `pip install mkdocs`
* Устанвите `mkdocs-material` с помощью `pip install mkdocs-material`
* Устанвите `mkdocs-minify-plugin` с помощью `pip install mkdocs-minify-plugin`
* Устанвите `pymdown-extensions` (может быть уже установлен)

## Создание и тестирование изменений в вики

> **Перед тем как делать что либо, рекомендуем прочесть документацию по mkdocs.**
> [**Нажать сюда**](https://www.mkdocs.org/) для более глубокого объяснения как использовать mkdocs.

1. ``cd`` внутрь репозитория (где лежит `mkdocs.yml`)
2. Запустить``mkdocs serve`` для создания тестового окружения на ``http://127.0.0.1:8000/`` . Что бы не повторять это часто, мы написали `serve_website.bat` и `serve_website` (скрипт на шелле) которые будут запускать эти команды.
3. Если довольны изменениями, пуште изменения в репозиторий.
    - Сервер автоматически пересоберёт проект и он будет виден на https://07th-mod.com/wiki/
    - Вам так же потребуется **обновить страницу в браузере** что бы увидеть изменения (если попробуете зайти на другую страницу внутри сайта может загрузиться кешированная страница!)
4. Если нужно создать локальную HTML версию сайта, запустите ``mkdocs build`` который создаст вебсайт из этого проекта.

## Как перевести эту вики

1. Форкнуть репозиторий
2. Перевести все файлы и изменить ``mkdocs.yml`` в соответствии с переводом.
3. **Не создавайте пулл реквест с переводом!** Мы рекомендуем оповестить нас о форке, мы соберём исходники и добавим форк в нашу вики. 

## Полезная информация о вики

### Полезные раширения для markdown

Markdown расширения описываются в `mkdocs.yml`.
Расширения начинаются с `pymdownx` как часть PyMdown Extensions
package. [Клик сюда](https://facelessuser.github.io/pymdown-extensions/extensions/arithmatex/)
что бы увидеть полный список расширений. Заметьте, что каждое расширение
должно быть доступно в файле `mkdcos.yml` до его использования.

#### Использование Pymdownx Snippets расширений

[pymdownx.snippets](https://facelessuser.github.io/pymdown-extensions/extensions/snippets/) расширение, позволяющее использовать сниппеты в папочке `snippets`.

Вы можете использовать следующий синтаксис для включения файла под названием `Cross-Platform-Installer.md`, который расположен в папочке со сниппетами:

`--8<-- "Cross-Platform-Installer.md"`

Если этот файл отсутствует, страница не будет отображена и в консоль выведется ошибка.

### Структура папок в Вики / Репозитории 

* `dev_scripts` - удобные скрипты для установки для запуска mkdocs
* `docs` - корневая директория вики, но обратите внимание, что `mkdocs.yml` используется mkdocs, пусть он и вне `docs` папки.
* `mkdocs.yml` - содержит меню вики, мета данные и какие плагины должны быть использованно
* `docs\Higurashi` и `docs\Umineko` - файлы, содержащие документацию для Цикад и Чаек соответсвенно
* `docs\Snippets` - сниппеты, необходимые для отображения некоторых страниц вики (смотрите выше для доп. информации)

### Картинки

Картинки сейчас лежат на сайте 07th-mod, и ручками грузятся на сервер.
